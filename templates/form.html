<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ action }} Record</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
  <div class="card shadow p-4">
    <h3 class="mb-4">{{ action }} Record</h3>

    <form method="post" enctype="multipart/form-data">
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Name of Applicant</label>
          <input type="text" class="form-control" name="name" value="{{ rec.name or '' }}" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Epic No</label>
          <input type="text" class="form-control" name="epic" value="{{ rec.epic or '' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">PS No</label>
          <input type="text" class="form-control" name="ps" value="{{ rec.ps or '' }}">
        </div>

        <div class="col-md-3">
          <label class="form-label">Old H.No</label>
          <input type="text" class="form-control" name="old_house" value="{{ rec.old_house or '' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">New H.No</label>
          <input type="text" class="form-control" name="new_house" value="{{ rec.new_house or '' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Payment (â‚¹)</label>
          <input type="number" step="0.01" class="form-control" name="payment" value="{{ rec.payment or 0 }}">
        </div>

        <div class="col-md-3">
          <label class="form-label">Paid?</label>
          <select class="form-select" name="paid">
            <option value="">Select</option>
            <option value="paid" {% if rec.paid == 'paid' %}selected{% endif %}>Paid</option>
            <option value="unpaid" {% if rec.paid == 'unpaid' %}selected{% endif %}>Unpaid</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Complete?</label>
          <select class="form-select" name="complete">
            <option value="">Select</option>
            <option value="complete" {% if rec.complete == 'complete' %}selected{% endif %}>Complete</option>
            <option value="pending" {% if rec.complete == 'pending' %}selected{% endif %}>Pending</option>
          </select>
        </div>

        <div class="col-md-6">
          <label class="form-label">Wife Name</label>
          <input type="text" class="form-control" name="wife_name" value="{{ rec.wife_name or '' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Wife Epic</label>
          <input type="text" class="form-control" name="wife_epic" value="{{ rec.wife_epic or '' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Wife Payment (â‚¹)</label>
          <input type="number" step="0.01" class="form-control" name="wife_payment" value="{{ rec.wife_payment or 0 }}">
        </div>

        <div class="col-md-3">
          <label class="form-label">Wife Paid?</label>
          <select class="form-select" name="wife_paid">
            <option value="">Select</option>
            <option value="paid" {% if rec.wife_paid == 'paid' %}selected{% endif %}>Paid</option>
            <option value="unpaid" {% if rec.wife_paid == 'unpaid' %}selected{% endif %}>Unpaid</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Wife Complete?</label>
          <select class="form-select" name="wife_complete">
            <option value="">Select</option>
            <option value="complete" {% if rec.wife_complete == 'complete' %}selected{% endif %}>Complete</option>
            <option value="pending" {% if rec.wife_complete == 'pending' %}selected{% endif %}>Pending</option>
          </select>
        </div>

        <div class="col-md-6">
          <label class="form-label">Remark</label>
          <textarea class="form-control" name="remark" rows="2">{{ rec.remark or '' }}</textarea>
        </div>

        <!-- ðŸ§¾ Multiple PDF Upload -->
        <div class="col-md-6">
          <label class="form-label">Upload PDFs</label>
          <input type="file" class="form-control" name="pdfs" accept="application/pdf" multiple>

          {% if rec.pdf_urls and rec.pdf_urls|length > 0 %}
            <ul class="list-group mt-3">
              {% for url in rec.pdf_urls %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <a href="{{ url }}" target="_blank" class="text-decoration-none text-info">
                    <i class="bi bi-file-earmark-pdf-fill"></i> PDF {{ loop.index }}
                  </a>
                  <form method="post" action="{{ url_for('delete_pdf', record_id=rec.id) }}" class="m-0">
  <input type="hidden" name="pdf_url" value="{{ url }}">
  <button type="submit" class="btn btn-sm btn-outline-danger">
    <i class="bi bi-trash"></i> Delete
  </button>
</form>
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>

      <div class="mt-4">
        <button class="btn btn-primary" type="submit">
          <i class="bi bi-save"></i> Save
        </button>
        <a href="{{ url_for('index') }}" class="btn btn-secondary ms-2">
          <i class="bi bi-arrow-left"></i> Back
        </a>
      </div>
    </form>
  </div>
</div>

</body>
</html>
